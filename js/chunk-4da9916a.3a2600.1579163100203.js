(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4da9916a"],{"1aec":function(e,r,t){"use strict";var i=t("f5ed");t.n(i).a},a1e1:function(e,r,t){},a2f6:function(e,r,t){"use strict";var i=t("a1e1");t.n(i).a},ed50:function(e,r,t){"use strict";t.r(r),t("8e6e"),t("ac6a"),t("456d"),t("c5f6");var i=t("bd86"),o=t("75fc"),n=(t("6762"),t("2fdb"),t("7f7f"),t("e7e5"),t("d399")),a=(t("5f5f"),t("f253")),l=(t("8a58"),t("e41f")),s=(t("0653"),t("34e9")),c=(t("be7f"),t("565f")),u=t("4ed9"),p=t("3a5e"),d=t("8d51");function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function f(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(t,!0).forEach((function(r){Object(i.a)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(t).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var m={name:"Information",data:function(){return{loginModalShow:!1,islinkPhone:"",count:0,showPicker:!1,linkCreditTypes:[],orderRules:[],num:1,people:[],custFieldValue:[],contacts:{},isCouponError:!1,couponErrorType:"",couponErrParams:{}}},components:{Field:c.a,CellGroup:s.a,Popup:l.a,Picker:a.a,Loading:p.a,LoginModal:u.a},computed:{guestInputs:function(){if(!this.orderRules.guestInputs)return[];for(var e=[],r=this.orderRules.guestInputs,t=0;t<r.length;t++)0===r[t].single&&e.push(r[t]);return e},getUserInfo:function(){return this.$store.state.userInfo},isWechat:function(){return window.$browser.WeChat}},methods:{cancelOrder:function(){this.isCouponError=!1},continueOrder:function(){var e=this;this.isCouponError=!1,this.couponErrParams.couponAmount=0,this.couponErrParams.couponCodeIdList=[],this.couponErrParams.realityAmount=this.couponErrParams.payableAmount,Object(d.a)(this.couponErrParams).catch((function(r){r.couponErrorType&&(e.couponErrorType="1"===r.couponErrorType?"活动太火爆该优惠券额度已用完":"该优惠券暂不可用",n.a.clear(),e.isCouponError=!0,e.couponErrParams=r),2===r.status&&r.orderId&&(n.a.clear(),e.$router.push("/payStatus?payfrom=pay&orderId=".concat(r.orderId)))}))},handleClear:function(){this.loginModalShow=!1},handleLoginModal:function(){this.handleDispose()},handleShowPicker:function(e){this.count=e,this.showPicker=!0},onConfirm:function(e){var r=this,t=JSON.parse(JSON.stringify(this.people));t.map((function(t,i){r.count===i&&(t.certificate=e.name,t.linkCreditType=e.value,t.errorCertificate=!1)})),this.people=t,this.showPicker=!1},handleDispose:function(){var e=this;if(this.isWechat){if(!this.getUserInfo.custId&&!this.browser)return!(this.loginModalShow=!0);var r=this.people,t=!0;r.map((function(r,i){e.orderRules.custField.includes("link_credit_no")&&!r.certificate&&(r.errorCertificate=!0,t=!1)})),this.handleClick(t)}else this.$router.push("/login")},handleClick:function(e){var r=this;this.$validator.validateAll().then((function(t){if(e&&t){localStorage.setItem("people",JSON.stringify(r.people));var i=[];if(0<r.custFieldValue.length){var a=JSON.parse(JSON.stringify(r.people));a.map((function(e,t){e.custFieldValue=r.custFieldValue[t]})),i=a}else i=Object(o.a)(r.people);var l=f({},JSON.parse(localStorage.getItem("contacts")),{people:i});Object(d.a)(l).catch((function(e){e.couponErrorType&&(r.couponErrorType="1"===e.couponErrorType?"活动太火爆该优惠券额度已用完":"该优惠券暂不可用",n.a.clear(),r.isCouponError=!0,r.couponErrParams=e),2===e.status&&e.orderId&&(n.a.clear(),r.$router.push("/payStatus?payfrom=pay&orderId=".concat(e.orderId)))}))}}))},initCardInfo:function(){var e=this.orderRules.linkCreditTypes;e.map((function(e,r){e.text=e.name})),this.linkCreditTypes=e;for(var r=[],t=this.guestInputs,i=function(e){var i=[];t.map((function(e,r){var t=f({},e,{value:""});i.push(t)})),r.push(i)},o=0;o<this.num;o++)i();this.custFieldValue=r},initPageDate:function(){var e=localStorage.getItem("people")&&JSON.parse(localStorage.getItem("people")).slice(0,this.num);if(e){var r=this.num;if(r>e.length)for(var t=0,i=r-e.length;t<i;t++)e.push({linkCreditNo:"",linkCreditType:"",certificate:"",linkEmail:"",linkMan:"",linkPhone:"",errorCertificate:!1});this.people=e}else{for(var o={linkCreditNo:"",linkCreditType:"",certificate:"",linkEmail:"",linkMan:"",linkPhone:"",errorCertificate:!1},n=[],a=0;a<this.num;a++){var l=f({},o);n.push(l)}this.people=n}}},mounted:function(){this.num=Number(this.$router.history.current.query.num)-1,this.orderRules=JSON.parse(localStorage.getItem("orderRules")),this.contacts=JSON.parse(localStorage.getItem("contacts")),this.islinkPhone=this.contacts.linkPhone,this.initCardInfo(),this.initPageDate()}},v=(t("a2f6"),t("1aec"),t("2877")),k=Object(v.a)(m,(function(){var e=this,r=e.$createElement,i=e._self._c||r;return 0===e.people.length?i("Loading"):i("div",{staticClass:"information-page"},[e._l(e.num,(function(r,t){return i("div",{key:t,staticClass:"box"},[i("div",{staticClass:"box-title"},[e._v("客户信息"+e._s(r))]),i("CellGroup",[e.orderRules.custField.includes("link_man")?i("Field",{directives:[{name:"validate",rawName:"v-validate",value:"required|name",expression:"'required|name'"}],attrs:{label:"联系人",placeholder:"请填写客户姓名",required:"",clearable:"",name:"linkMan"+(r-1),"error-message":e.errors.first("linkMan"+(r-1)),error:e.errors.has("linkMan"+(r-1))},model:{value:e.people[r-1].linkMan,callback:function(t){e.$set(e.people[r-1],"linkMan",t)},expression:"people[count - 1].linkMan"}}):e._e(),e.orderRules.custField.includes("link_phone")?i("Field",{directives:[{name:"validate",rawName:"v-validate",value:"required|mobile",expression:"'required|mobile'"}],attrs:{clearable:"",type:"tel",label:"手机号",placeholder:"请填写手机号",required:"",name:"linkPhone"+(r-1),"error-message":e.errors.first("linkPhone"+(r-1)),error:e.errors.has("linkPhone"+(r-1))},model:{value:e.people[r-1].linkPhone,callback:function(t){e.$set(e.people[r-1],"linkPhone",t)},expression:"people[count - 1].linkPhone"}}):e._e(),e.orderRules.custField.includes("link_credit_no")?i("Field",{attrs:{readonly:"",clickable:"",value:e.people[r-1].certificate,label:"证件",placeholder:"请选择证件类型 >",required:"",name:"linkCreditType"+(r-1),error:e.people[r-1].errorCertificate},on:{click:function(t){return e.handleShowPicker(r-1)}}}):e._e(),e.orderRules.custField.includes("link_credit_no")?i("Field",{directives:[{name:"show",rawName:"v-show",value:e.people[r-1].certificate,expression:"people[count - 1].certificate"},{name:"validate",rawName:"v-validate",value:"required|link_credit_no",expression:"'required|link_credit_no'"}],attrs:{label:5<e.people[r-1].certificate.length?e.people[r-1].certificate.slice(0,5)+"...":e.people[r-1].certificate,placeholder:"请填写证件号",clearable:"",required:"",name:"linkCreditNo"+(r-1),"error-message":e.errors.first("linkCreditNo"+(r-1)),error:e.errors.has("linkCreditNo"+(r-1))},model:{value:e.people[r-1].linkCreditNo,callback:function(t){e.$set(e.people[r-1],"linkCreditNo",t)},expression:"people[count - 1].linkCreditNo"}}):e._e(),e.orderRules.custField.includes("link_email")?i("Field",{directives:[{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"}],attrs:{label:"email",placeholder:"请填写email",clearable:"",required:"",name:"linkEmail"+(r-1),"error-message":e.errors.first("linkEmail"+(r-1)),error:e.errors.has("linkEmail"+(r-1))},model:{value:e.people[r-1].linkEmail,callback:function(t){e.$set(e.people[r-1],"linkEmail",t)},expression:"people[count - 1].linkEmail"}}):e._e(),e._l(e.guestInputs,(function(t,o){return i("Field",{directives:[{name:"validate",rawName:"v-validate",value:"1"==t.notnull?"required":"",expression:"item.notnull == '1' ? 'required' : ''"}],key:o,attrs:{label:t.name,placeholder:t.desc,clearable:"",required:"1"==t.notnull,name:""+t.name+(r-1),"error-message":e.errors.first(""+t.name+(r-1)),error:e.errors.has(""+t.name+(r-1))},model:{value:e.custFieldValue[r-1][o].value,callback:function(t){e.$set(e.custFieldValue[r-1][o],"value",t)},expression:"custFieldValue[count - 1][i].value"}})}))],2)],1)})),i("div",{staticClass:"information-btn"},[i("div",{staticClass:"btn",on:{click:e.handleDispose}},[e._v("\n      确定\n    ")])]),i("Popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(r){e.showPicker=r},expression:"showPicker"}},[i("Picker",{attrs:{"show-toolbar":"",columns:e.linkCreditTypes},on:{cancel:function(r){e.showPicker=!1},confirm:e.onConfirm}})],1),e.isCouponError?i("div",{on:{touchmove:function(e){e.preventDefault()}}},[i("div",{staticClass:"mask"}),i("div",{staticClass:"away-pop"},[i("img",{staticClass:"top-img",attrs:{src:t("2b81"),alt:""}}),i("div",{staticClass:"bottom"},[i("div",{staticClass:"content-text-coupon"},[i("p",{staticClass:"text-title"},[e._v(e._s(e.couponErrorType))]),i("p",{staticClass:"text-content"},[e._v("其实不用券也超划算的～")])]),i("div",{staticClass:"btns"},[i("div",{staticClass:"btns-l",on:{click:e.cancelOrder}},[e._v("暂时取消")]),i("i",{staticClass:"line"}),i("div",{staticClass:"btns-r",on:{click:e.continueOrder}},[e._v("继续下单")])])])])]):e._e(),e.loginModalShow?i("LoginModal",{attrs:{phone:e.islinkPhone},on:{clear:e.handleClear,login:e.handleLoginModal}}):e._e()],2)}),[],!1,null,"4fdad6a4",null);r.default=k.exports},f5ed:function(e,r,t){}}]);